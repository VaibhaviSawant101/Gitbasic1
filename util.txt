This is the utility function of the second file version