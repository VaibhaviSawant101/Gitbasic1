This is the utility function of the first file version